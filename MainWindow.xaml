<Window x:Class="FilKollen.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:FilKollen.Converters"
        Title="FilKollen - Skydd mot bluffnotiser och hackare"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        Height="750"
        Width="1100"
        MinHeight="650"
        MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Style="{DynamicResource FK.Style.MainWindow}"
        Icon="Resources/Icons/filkollen.ico"
        KeyDown="Window_KeyDown"
        PreviewKeyDown="Window_PreviewKeyDown">

        <Window.Resources>
                <ResourceDictionary>
                        <ResourceDictionary.MergedDictionaries>
                                <ResourceDictionary Source="Themes/ModernComponents.xaml"/>
                        </ResourceDictionary.MergedDictionaries>
                        <converters:WidthToColumnConverter x:Key="WidthToColumnConverter"/>
                        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
                </ResourceDictionary>
        </Window.Resources>

        <!-- Root chrome med FilKollen tema -->
        <Border Background="{DynamicResource FK.Brush.Bg}"
                CornerRadius="16"
                BorderBrush="{DynamicResource FK.Brush.Border}"
                BorderThickness="1">
                <Grid>
                        <Grid.RowDefinitions>
                                <RowDefinition Height="70"/>
                                <!-- Header -->
                                <RowDefinition Height="*"/>
                                <!-- Main Content Area -->
                                <RowDefinition Height="60"/>
                                <!-- Footer -->
                        </Grid.RowDefinitions>

                        <!-- Invisible resize borders for accessibility -->
                        <Border x:Name="ResizeBorderTop" Cursor="SizeNS" Height="6" VerticalAlignment="Top" Background="Transparent" MouseDown="ResizeBorder_MouseDown"/>
                        <Border x:Name="ResizeBorderBottom" Cursor="SizeNS" Height="6" VerticalAlignment="Bottom" Background="Transparent" MouseDown="ResizeBorder_MouseDown"/>
                        <Border x:Name="ResizeBorderLeft" Cursor="SizeWE" Width="6" HorizontalAlignment="Left" Background="Transparent" MouseDown="ResizeBorder_MouseDown"/>
                        <Border x:Name="ResizeBorderRight" Cursor="SizeWE" Width="6" HorizontalAlignment="Right" Background="Transparent" MouseDown="ResizeBorder_MouseDown"/>

                        <!-- === HEADER MED CENTRERAD TRIAL BADGE === -->
                        <Grid Grid.Row="0"
                              Background="Transparent"
                              MouseDown="TopBar_MouseDown">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Logo/Brand area (vÃ¤nster) -->
                                <StackPanel Grid.Column="0"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"
                                            Margin="24,0,0,0">

                                        <!-- Klickbar logga utan hover-effekt -->
                                        <Button x:Name="BrandLogo"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Padding="0"
                                                Click="BrandLogo_Click"
                                                Visibility="Collapsed"
                                                UseLayoutRounding="True"
                                                SnapsToDevicePixels="True"
                                                Cursor="Hand"
                                                Focusable="False">
                                                <Button.Style>
                                                        <Style TargetType="Button">
                                                                <Setter Property="Background"
                                                                                Value="Transparent"/>
                                                                <Setter Property="BorderThickness"
                                                                                Value="0"/>
                                                                <Setter Property="Template">
                                                                        <Setter.Value>
                                                                                <ControlTemplate TargetType="Button">
                                                                                        <Border Background="Transparent">
                                                                                                <ContentPresenter/>
                                                                                        </Border>
                                                                                </ControlTemplate>
                                                                        </Setter.Value>
                                                                </Setter>
                                                        </Style>
                                                </Button.Style>

                                                <!-- ENDA barnet till knappen -->
                                                <Image Height="48"
                                                       SnapsToDevicePixels="True"
                                                       UseLayoutRounding="True"
                                                       Stretch="Uniform"
                                                       RenderOptions.BitmapScalingMode="HighQuality"
                                                       RenderOptions.EdgeMode="Aliased"/>
                                        </Button>
                                        <!-- Viktigt: stÃ¤ng knappen hÃ¤r -->

                                        <!-- Fallback till text (separat element, inte inuti knappen) -->
                                        <StackPanel x:Name="BrandFallback"
                                                    Orientation="Horizontal"
                                                    Visibility="Visible">
                                                <Border Width="46"
                                                        Height="46"
                                                        Margin="0,0,18,0"
                                                        VerticalAlignment="Center"
                                                        Background="{DynamicResource FK.Brush.Primary}"
                                                        CornerRadius="10">
                                                        <TextBlock Text="FK"
                                                                   FontWeight="Bold"
                                                                   FontSize="20"
                                                                   Foreground="White"
                                                                   HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                </Border>
                                                <StackPanel>
                                                        <TextBlock Text="FILKOLLEN"
                                                                   FontWeight="Bold"
                                                                   FontSize="28"
                                                                   Foreground="{DynamicResource FK.Brush.Primary}"
                                                                   VerticalAlignment="Center"/>
                                                        <TextBlock Text="Skydd mot bluffnotiser och hackare"
                                                                   FontSize="13"
                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                   Margin="0,-2,0,0"
                                                                   VerticalAlignment="Center"/>
                                                </StackPanel>
                                        </StackPanel>
                                </StackPanel>

                                <!-- CENTRERAD Trial Badge (klickbar) -->
                                <Button Grid.Column="1"
                                        x:Name="TrialBadgeButton"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Padding="0"
                                        Cursor="Hand"
                                        Click="TrialBadgeButton_Click"
                                        Visibility="{Binding IsTrialMode, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <Button.Style>
                                                <Style TargetType="Button">
                                                        <Setter Property="Background"
                                                                Value="Transparent"/>
                                                        <Setter Property="Template">
                                                                <Setter.Value>
                                                                        <ControlTemplate TargetType="Button">
                                                                                <Border Background="{TemplateBinding Background}"
                                                                                        CornerRadius="16"
                                                                                        BorderThickness="0">
                                                                                        <ContentPresenter/>
                                                                                </Border>
                                                                                <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsMouseOver"
                                                                                                 Value="True">
                                                                                                <Setter Property="Background"
                                                                                                        Value="#44000000"/>
                                                                                        </Trigger>
                                                                                </ControlTemplate.Triggers>
                                                                        </ControlTemplate>
                                                                </Setter.Value>
                                                        </Setter>
                                                </Style>
                                        </Button.Style>

                                        <Border x:Name="TrialBadge"
                                                Style="{StaticResource FK.Style.TrialBadge}"
                                                Padding="16,8">
                                                <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="ðŸ”‘"
                                                                   FontSize="14"
                                                                   Margin="0,0,8,0"
                                                                   VerticalAlignment="Center"/>
                                                        <TextBlock x:Name="TrialBadgeText"
                                                                   Text="PROVPERIOD AKTIVT"
                                                                   Style="{StaticResource FK.Style.BadgeText}"
                                                                   FontSize="12"
                                                                   FontWeight="Bold"/>
                                                </StackPanel>
                                        </Border>
                                </Button>

                                <!-- Window controls och theme toggle (hÃ¶ger) -->
                                <StackPanel Grid.Column="2"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Right"
                                            Margin="0,0,16,0">

                                        <!-- FÃ–RBÃ„TTRAD Ljus/MÃ¶rk tema toggle med ikoner utanfÃ¶r -->
                                        <StackPanel Orientation="Horizontal"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,20,0">
                                                <TextBlock Text="â˜€ï¸"
                                                           FontSize="18"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,12,0"
                                                           Foreground="{DynamicResource FK.Brush.Subtext}"/>
                                                
                                                <ToggleButton x:Name="ThemeToggle"
                                                              Style="{StaticResource FK.Style.PremiumThemeToggle}"
                                                              Width="56"
                                                              Height="30"
                                                              Checked="ThemeToggle_Checked"
                                                              Unchecked="ThemeToggle_Unchecked"/>
                                                
                                                <TextBlock Text="ðŸŒ™"
                                                           FontSize="18"
                                                           VerticalAlignment="Center"
                                                           Margin="12,0,0,0"
                                                           Foreground="{DynamicResource FK.Brush.Subtext}"/>
                                        </StackPanel>

                                        <!-- Window controls (DESSA SKA VARA INNE I SAMMA STACKPANEL) -->
                                        <Button Content="âˆ’"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Minimize_Click"/>
                                        <Button Content="â–¡"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Maximize_Click"/>
                                        <Button Content="âœ•"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Close_Click"/>
                                </StackPanel>
                        </Grid>


                        <!-- === FÃ–RBÃ„TTRAD TVÃ…-KOLUMNS LAYOUT === -->
                        <Grid Grid.Row="1"
                                        Margin="0,0,0,24">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="400"/>
                                        <!-- Ã–kad frÃ¥n 360 fÃ¶r bÃ¤ttre balans -->
                                        <ColumnDefinition Width="*"/>
                                        <!-- HÃ¶ger: statuspanel + hotlista -->
                                </Grid.ColumnDefinitions>

                                <!-- VÃ„NSTER KOLUMN: FÃ¶rstÃ¤rkta skyddskort -->
                                <StackPanel Grid.Column="0"
                                                Margin="24,0,16,0">
                                        <!-- Auto-skydd panel (fÃ¶rstÃ¤rkt) -->
                                        <Border Style="{DynamicResource FK.Style.ProtectionCard}"
                                                MinHeight="150"
                                                Margin="0,0,0,18">
                                                <Grid>
                                                        <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="*"/>
                                                                <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>

                                                        <TextBlock Grid.Row="0"
                                                                   Text="AUTO-SKYDD"
                                                                   FontSize="20"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource FK.Brush.Text}"
                                                                   HorizontalAlignment="Center"
                                                                   Margin="0,0,0,16"/>

                                                        <ToggleButton Grid.Row="1"
                                                                      x:Name="ProtectionToggle"
                                                                      Style="{StaticResource FK.Style.PremiumToggle}"
                                                                      Width="70"
                                                                      Height="35"
                                                                      HorizontalAlignment="Center"
                                                                      Margin="0,0,0,16"
                                                                      Checked="ProtectionToggle_Checked"
                                                                      Unchecked="ProtectionToggle_Unchecked"/>

                                                        <TextBlock Grid.Row="3"
                                                                   Text="Ã–vervakar filer i realtid."
                                                                   FontSize="13"
                                                                   Opacity="0.8"
                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                   HorizontalAlignment="Center"
                                                                   TextWrapping="Wrap"
                                                                   TextAlignment="Center"
                                                                   MaxWidth="200"/>
                                                </Grid>
                                        </Border>

                                        <!-- IP-Skydd panel (fÃ¶rstÃ¤rkt) -->
                                        <Border Style="{DynamicResource FK.Style.ProtectionCard}"
                                                MinHeight="150"
                                                Margin="0,0,0,18">
                                                <Grid>
                                                        <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="*"/>
                                                                <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>

                                                        <TextBlock Grid.Row="0"
                                                                   Text="IP-SKYDD"
                                                                   FontSize="20"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource FK.Brush.Text}"
                                                                   HorizontalAlignment="Center"
                                                                   Margin="0,0,0,16"/>

                                                        <ToggleButton Grid.Row="1"
                                                                      x:Name="IpProtectionToggle"
                                                                      Style="{StaticResource FK.Style.PremiumToggle}"
                                                                      Width="70"
                                                                      Height="35"
                                                                      HorizontalAlignment="Center"
                                                                      Margin="0,0,0,16"
                                                                      Checked="IpProtectionToggle_Checked"
                                                                      Unchecked="IpProtectionToggle_Unchecked"/>

                                                        <TextBlock Grid.Row="3"
                                                                   Text="Maskerar din IP-adress online."
                                                                   FontSize="13"
                                                                   Opacity="0.8"
                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                   HorizontalAlignment="Center"
                                                                   TextWrapping="Wrap"
                                                                   TextAlignment="Center"
                                                                   MaxWidth="220"/>
                                                </Grid>
                                        </Border>

                                        <!-- WebblÃ¤sarskydd panel (fÃ¶rstÃ¤rkt) -->
                                        <Border Style="{DynamicResource FK.Style.ProtectionCard}"
                                                MinHeight="150">
                                                <Grid>
                                                        <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="*"/>
                                                                <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>

                                                        <TextBlock Grid.Row="0"
                                                                   Text="WEBBLÃ„SARSKYDD"
                                                                   FontSize="20"
                                                                   FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource FK.Brush.Text}"
                                                                   HorizontalAlignment="Center"
                                                                   TextAlignment="Center"
                                                                   Margin="0,0,0,16"/>

                                                        <Button Grid.Row="1"
                                                                x:Name="BrowserCleanTileButton"
                                                                Content="Rensa bluffnotiser"
                                                                Style="{DynamicResource FK.Style.PrimaryButton}"
                                                                HorizontalAlignment="Center"
                                                                Padding="20,12"
                                                                FontSize="14"
                                                                Click="BrowserCleanButton_Click"/>

                                                        <TextBlock Grid.Row="3"
                                                                   Text="Tar bort falska varningar och bluffnotiser i webblÃ¤saren."
                                                                   FontSize="13"
                                                                   Opacity="0.8"
                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                   HorizontalAlignment="Center"
                                                                   TextWrapping="Wrap"
                                                                   TextAlignment="Center"
                                                                   MaxWidth="240"
                                                                   Margin="0,16,0,0"/>
                                                </Grid>
                                        </Border>
                                </StackPanel>

                                <!-- HÃ–GER KOLUMN: FÃ¶rbÃ¤ttrad statuspanel -->
                                <Grid Grid.Column="1"
                                                Margin="16,0,24,0">
                                        <StackPanel HorizontalAlignment="Stretch">

                                                <!-- FÃ–RBÃ„TTRAD statuspanel enligt spec -->
                                                <Border Style="{DynamicResource FK.Style.StatusCard}"
                                                        Margin="0,0,0,16"
                                                        MaxWidth="1000"
                                                        HorizontalAlignment="Center">
                                                        <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                </Grid.ColumnDefinitions>

                                                                <!-- Status indikator och text -->
                                                                <StackPanel Grid.Column="0"
                                                                            Orientation="Horizontal"
                                                                            VerticalAlignment="Center">
                                                                        <Ellipse x:Name="StatusIndicator"
                                                                                 Width="24"
                                                                                 Height="24"
                                                                                 Fill="{DynamicResource FK.Brush.StatusNeutral}"
                                                                                 Margin="0,0,18,0"/>

                                                                        <StackPanel>
                                                                                <StackPanel Orientation="Horizontal">
                                                                                        <!-- FÃ–RSTÃ„RKT: 22px istÃ¤llet fÃ¶r 20px -->
                                                                                        <TextBlock x:Name="StatusMainText"
                                                                                                   Text="SYSTEMET Ã„R SÃ„KERT"
                                                                                                   FontSize="22"
                                                                                                   FontWeight="Bold"
                                                                                                   Foreground="{DynamicResource FK.Brush.Text}"/>

                                                                                        <!-- Hot-rÃ¤knare -->
                                                                                        <Border x:Name="ThreatCounter"
                                                                                                Background="{DynamicResource FK.Brush.Danger}"
                                                                                                CornerRadius="18"
                                                                                                Padding="14,6"
                                                                                                Margin="18,0,0,0"
                                                                                                Visibility="Collapsed">
                                                                                                <TextBlock x:Name="ThreatCountText"
                                                                                                           Text="2 HOT"
                                                                                                           FontSize="14"
                                                                                                           FontWeight="Bold"
                                                                                                           Foreground="White"/>
                                                                                        </Border>
                                                                                </StackPanel>
                                                                                <!-- FÃ–RSTÃ„RKT: 12px och 70% opacitet -->
                                                                                <TextBlock x:Name="StatusSubText"
                                                                                           Text="0 hot funna â€¢ Auto-skydd inaktivt"
                                                                                           FontSize="12"
                                                                                           Opacity="0.7"
                                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"/>
                                                                        </StackPanel>
                                                                </StackPanel>

                                                                <!-- FÃ–RBÃ„TTRADE Statistik-chips -->
                                                                <Border Grid.Column="2"
                                                                        Background="{DynamicResource FK.Brush.Surface}"
                                                                        CornerRadius="12"
                                                                        Padding="16,10"
                                                                        Margin="0,0,12,0"
                                                                        BorderThickness="1"
                                                                        BorderBrush="{DynamicResource FK.Brush.Border}">
                                                                        <StackPanel HorizontalAlignment="Center">
                                                                                <TextBlock Text="SENASTE SKANNING"
                                                                                           FontSize="10"
                                                                                           FontWeight="SemiBold"
                                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                                           HorizontalAlignment="Center"/>
                                                                                <TextBlock x:Name="LastScanText"
                                                                                           Text="Aldrig"
                                                                                           FontSize="14"
                                                                                           FontWeight="Medium"
                                                                                           Foreground="{DynamicResource FK.Brush.Text}"
                                                                                           HorizontalAlignment="Center"/>
                                                                        </StackPanel>
                                                                </Border>

                                                                <Border Grid.Column="3"
                                                                        Background="{DynamicResource FK.Brush.Surface}"
                                                                        CornerRadius="12"
                                                                        Padding="16,10"
                                                                        BorderThickness="1"
                                                                        BorderBrush="{DynamicResource FK.Brush.Border}">
                                                                        <StackPanel HorizontalAlignment="Center">
                                                                                <TextBlock Text="HOT HANTERADE"
                                                                                           FontSize="10"
                                                                                           FontWeight="SemiBold"
                                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                                           HorizontalAlignment="Center"/>
                                                                                <TextBlock x:Name="ThreatsHandledText"
                                                                                           Text="0"
                                                                                           FontSize="14"
                                                                                           FontWeight="Medium"
                                                                                           Foreground="{DynamicResource FK.Brush.Text}"
                                                                                           HorizontalAlignment="Center"/>
                                                                        </StackPanel>
                                                                </Border>

                                                                <!-- Ã…tgÃ¤rdsknappar -->
                                                                <StackPanel Grid.Column="4"
                                                                            Orientation="Horizontal"
                                                                            VerticalAlignment="Center"
                                                                            Margin="24,0,0,0">
                                                                        <Button x:Name="QuickScanButton"
                                                                                Content="SÃ¶k efter hot"
                                                                                Style="{DynamicResource FK.Style.PrimaryButton}"
                                                                                FontSize="15"
                                                                                Padding="22,12"
                                                                                Click="QuickScanButton_Click"/>
                                                                </StackPanel>
                                                        </Grid>
                                                </Border>

                                                <!-- Hotlista med maxbredd och centrering -->
                                                <Border Style="{DynamicResource FK.Style.ContentCard}"
                                                        MaxWidth="1200"
                                                        HorizontalAlignment="Center">
                                                        <Grid>
                                                                <!-- SÃ¤ker status -->
                                                                <StackPanel x:Name="SafeStatusPanel"
                                                                            Visibility="Visible">
                                                                        <Border Width="120"
                                                                                Height="120"
                                                                                CornerRadius="60"
                                                                                Background="{DynamicResource FK.Brush.Success}"
                                                                                HorizontalAlignment="Center"
                                                                                Margin="0,80,0,32">
                                                                                <TextBlock Text="âœ“"
                                                                                           FontSize="56"
                                                                                           Foreground="White"
                                                                                           HorizontalAlignment="Center"
                                                                                           VerticalAlignment="Center"/>
                                                                        </Border>

                                                                        <TextBlock Text="ALLT SER BRA UT!"
                                                                                   FontSize="28"
                                                                                   FontWeight="Bold"
                                                                                   HorizontalAlignment="Center"
                                                                                   Foreground="{DynamicResource FK.Brush.Success}"
                                                                                   Margin="0,0,0,16"/>

                                                                        <TextBlock Text="Allt ser bra ut! Aktivera auto-skydd fÃ¶r kontinuerlig Ã¶vervakning."
                                                                                   FontSize="17"
                                                                                   TextAlignment="Center"
                                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                                   TextWrapping="Wrap"
                                                                                   MaxWidth="600"
                                                                                   LineHeight="26"
                                                                                   HorizontalAlignment="Center"
                                                                                   Margin="0,0,0,60"/>
                                                                </StackPanel>

                                                                <!-- Hot-lista med modern ScrollViewer -->
                                                                <StackPanel x:Name="ThreatsPanel"
                                                                            Visibility="Collapsed">
                                                                        <!-- FÃ–RBÃ„TTRADE Ã¥tgÃ¤rdsknappar med tydlig hierarki -->
                                                                        <DockPanel Margin="0,0,0,28">
                                                                                <!-- Destruktiv knapp (vÃ¤nster) -->
                                                                                <Button x:Name="HandleAllThreatsButton"
                                                                                        Content="ðŸ—‘ï¸ Ta bort alla hot"
                                                                                        Style="{DynamicResource FK.Style.DangerButtonLarge}"
                                                                                        FontWeight="SemiBold"
                                                                                        FontSize="14"
                                                                                        Padding="20,12"
                                                                                        DockPanel.Dock="Left"
                                                                                        Click="HandleAllThreatsButton_Click"/>

                                                                                <!-- PrimÃ¤r knapp (hÃ¶ger) -->
                                                                                <Button x:Name="RefreshScanButton"
                                                                                        Content="ðŸ”„ Skanna om"
                                                                                        Style="{DynamicResource FK.Style.PrimaryButton}"
                                                                                        FontWeight="SemiBold"
                                                                                        FontSize="14"
                                                                                        Padding="20,12"
                                                                                        DockPanel.Dock="Right"
                                                                                        Margin="20,0,0,0"
                                                                                        Click="RefreshScanButton_Click"/>
                                                                        </DockPanel>

                                                                        <!-- Hot-tabell header med fÃ¶rbÃ¤ttrad sortering -->
                                                                        <Grid Margin="0,0,0,20">
                                                                                <Grid.ColumnDefinitions>
                                                                                        <ColumnDefinition Width="2*"/>
                                                                                        <!-- Filnamn -->
                                                                                        <ColumnDefinition Width="80"
                                                                                                        MinWidth="80"/>
                                                                                        <!-- Typ -->
                                                                                        <ColumnDefinition Width="110"
                                                                                                        MinWidth="110"/>
                                                                                        <!-- Storlek -->
                                                                                        <ColumnDefinition Width="1.5*"/>
                                                                                        <!-- SÃ¶kvÃ¤g -->
                                                                                        <ColumnDefinition Width="120"/>
                                                                                        <!-- Datum -->
                                                                                        <ColumnDefinition Width="90"/>
                                                                                        <!-- Risk -->
                                                                                        <ColumnDefinition Width="80"/>
                                                                                        <!-- Ã…tgÃ¤rd (kompakt) -->
                                                                                </Grid.ColumnDefinitions>

                                                                                <Button x:Name="FileNameHeader"
                                                                                        Grid.Column="0"
                                                                                        Content="FILNAMN"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <Button x:Name="TypeHeader"
                                                                                        Grid.Column="1"
                                                                                        Content="TYP"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <Button x:Name="SizeHeader"
                                                                                        Grid.Column="2"
                                                                                        Content="STORLEK"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <Button x:Name="PathHeader"
                                                                                        Grid.Column="3"
                                                                                        Content="SÃ–KVÃ„G"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <Button x:Name="DateHeader"
                                                                                        Grid.Column="4"
                                                                                        Content="SKAPAD"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <Button x:Name="RiskHeader"
                                                                                        Grid.Column="5"
                                                                                        Content="RISK"
                                                                                        Style="{StaticResource FK.Style.SortableHeader}"/>
                                                                                <TextBlock Grid.Column="6"
                                                                                           Text="Ã…TGÃ„RD"
                                                                                           FontSize="11"
                                                                                           FontWeight="SemiBold"
                                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                                           Padding="16,12"
                                                                                           HorizontalAlignment="Center"/>
                                                                        </Grid>

                                                                        <!-- Separator -->
                                                                        <Border Height="1"
                                                                                Background="{DynamicResource FK.Brush.Border}"
                                                                                Opacity="0.6"
                                                                                Margin="0,0,0,20"/>

                                                                        <!-- Hot-lista med modern scrollviewer -->
                                                                        <ScrollViewer x:Name="ThreatsScroll"
                                                                                      MaxHeight="380"
                                                                                      Style="{StaticResource FK.Style.ModernScrollViewer}">
                                                                                <StackPanel x:Name="ThreatsList">
                                                                                        <!-- Dynamiska hot-rader lÃ¤ggs till hÃ¤r -->
                                                                                </StackPanel>
                                                                        </ScrollViewer>
                                                                </StackPanel>
                                                        </Grid>
                                                </Border>
                                        </StackPanel>
                                </Grid>
                        </Grid>
                        <!-- === FÃ–RBÃ„TTRAD FOOTER - KONSISTENTA CHIPS === -->
                                <Border Grid.Row="2"
                                        Background="{DynamicResource FK.Brush.Surface}"
                                        BorderBrush="{DynamicResource FK.Brush.Border}"
                                        CornerRadius="0,0,16,16"
                                        BorderThickness="0,1,0,0">
                                        <Grid Margin="28,0">
                                                <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Online status chip -->
                                                <Border x:Name="OnlineStatusBadge"
                                                        Grid.Column="0"
                                                        Style="{StaticResource FK.Style.StatusBadge}">
                                                        <StackPanel Orientation="Horizontal">
                                                                <Ellipse x:Name="StatusDot"
                                                                         Width="7"
                                                                         Height="7"
                                                                         Fill="{DynamicResource FK.Brush.Success}"
                                                                         Margin="0,0,8,0"/>
                                                                <TextBlock x:Name="ConnectionStatusText"
                                                                           Text="ONLINE"
                                                                           Style="{StaticResource FK.Style.StatusBadgeText}"
                                                                           FontSize="10"/>
                                                        </StackPanel>
                                                </Border>

                                                <!-- Version (centrerad) -->
                                                <TextBlock Grid.Column="1"
                                                           Text="FilKollen v2.1"
                                                           FontSize="13"
                                                           Opacity="0.7"
                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>

                                                <!-- HjÃ¤lp-chip (matchar online status) -->
                                                <Button Grid.Column="2"
                                                        x:Name="HelpButton"
                                                        Style="{StaticResource FK.Style.HelpChipButton}"
                                                        Click="HelpButton_Click">
                                                        <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="â“"
                                                                           FontSize="12"
                                                                           Margin="0,0,6,0"
                                                                           VerticalAlignment="Center"/>
                                                                <TextBlock Text="HJÃ„LP"
                                                                           FontSize="11"
                                                                           FontWeight="SemiBold"/>
                                                        </StackPanel>
                                                </Button>
                                        </Grid>
                                </Border>

                        </Grid>
        </Border>
</Window>