<Window x:Class="FilKollen.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:FilKollen.Converters"
        Title="FilKollen - Skydd mot bluffnotiser och hackare"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        Height="750"
        Width="1200"
        MinHeight="650"
        MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Style="{DynamicResource FK.Style.MainWindow}"
        Icon="Resources/Icons/filkollen.ico">

        <Window.Resources>
                <converters:WidthToColumnConverter x:Key="WidthToColumnConverter"/>
                <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

                <!-- Progress bar style för scanning -->
                <Style x:Key="ScanProgressBar"
                       TargetType="ProgressBar">
                        <Setter Property="Background"
                                Value="{DynamicResource FK.Brush.Surface}"/>
                        <Setter Property="Foreground"
                                Value="{DynamicResource FK.Brush.Primary}"/>
                        <Setter Property="BorderThickness"
                                Value="0"/>
                        <Setter Property="Height"
                                Value="4"/>
                        <Setter Property="Template">
                                <Setter.Value>
                                        <ControlTemplate TargetType="ProgressBar">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="2">
                                                        <Border x:Name="PART_Track"
                                                                Background="Transparent">
                                                                <Border x:Name="PART_Indicator"
                                                                        Background="{TemplateBinding Foreground}"
                                                                        HorizontalAlignment="Left"
                                                                        CornerRadius="2"/>
                                                        </Border>
                                                </Border>
                                        </ControlTemplate>
                                </Setter.Value>
                        </Setter>
                </Style>

                <!-- Premium Threat Row Style with enhanced hover effects -->
                <Style x:Key="ThreatRowStyle"
                       TargetType="Border">
                        <Setter Property="Background"
                                Value="{DynamicResource FK.Brush.Surface}"/>
                        <Setter Property="BorderBrush"
                                Value="{DynamicResource FK.Brush.Border}"/>
                        <Setter Property="BorderThickness"
                                Value="1"/>
                        <Setter Property="CornerRadius"
                                Value="8"/>
                        <Setter Property="Margin"
                                Value="0,0,0,8"/>
                        <Setter Property="Padding"
                                Value="16,14"/>
                        <Setter Property="Cursor"
                                Value="Hand"/>
                        <Style.Triggers>
                                <Trigger Property="IsMouseOver"
                                         Value="True">
                                        <Setter Property="Background"
                                                Value="{DynamicResource FK.Brush.Hover}"/>
                                        <Setter Property="BorderBrush"
                                                Value="{DynamicResource FK.Brush.Primary}"/>
                                        <Setter Property="BorderThickness"
                                                Value="1.5"/>
                                        <Setter Property="Effect">
                                                <Setter.Value>
                                                        <DropShadowEffect Color="{DynamicResource FK.Color.Primary}"
                                                                          Direction="270"
                                                                          ShadowDepth="4"
                                                                          BlurRadius="12"
                                                                          Opacity="0.25"/>
                                                </Setter.Value>
                                        </Setter>
                                        <Setter Property="RenderTransform">
                                                <Setter.Value>
                                                        <TranslateTransform Y="-2"/>
                                                </Setter.Value>
                                        </Setter>
                                </Trigger>
                        </Style.Triggers>
                </Style>

                <!-- Premium Typography Styles -->
                <Style x:Key="HeaderTextStyle"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="18"/>
                        <Setter Property="FontWeight"
                                Value="SemiBold"/>
                        <Setter Property="Foreground"
                                Value="{DynamicResource FK.Brush.Text}"/>
                </Style>

                <Style x:Key="BodyTextStyle"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="14"/>
                        <Setter Property="Foreground"
                                Value="{DynamicResource FK.Brush.Text}"/>
                </Style>

                <Style x:Key="MetaTextStyle"
                       TargetType="TextBlock">
                        <Setter Property="FontSize"
                                Value="12"/>
                        <Setter Property="Foreground"
                                Value="{DynamicResource FK.Brush.Subtext}"/>
                </Style>
        </Window.Resources>

        <!-- Root chrome med FilKollen tema -->
        <Border Background="{DynamicResource FK.Brush.Bg}"
                CornerRadius="16"
                BorderBrush="{DynamicResource FK.Brush.Border}"
                BorderThickness="1">
                <Grid>
                        <Grid.RowDefinitions>
                                <RowDefinition Height="70"/>
                                <!-- Header -->
                                <RowDefinition Height="Auto"/>
                                <!-- Protection controls -->
                                <RowDefinition Height="Auto"/>
                                <!-- Status area -->
                                <RowDefinition Height="*"/>
                                <!-- Content area -->
                                <RowDefinition Height="60"/>
                                <!-- Footer -->
                        </Grid.RowDefinitions>

                        <!-- === HEADER === -->
                        <Grid Grid.Row="0"
                              Background="Transparent"
                              MouseDown="TopBar_MouseDown">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Logo/Brand area - Premium: Scaled up 10-15% with pixel snapping -->
                                <StackPanel Grid.Column="0"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            Margin="24,0,0,0">
                                        <!-- Klickbar logga (Premium: Button med transparent stil) -->
                                        <Button x:Name="BrandLogo"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Padding="0"
                                                Click="BrandLogo_Click"
                                                Visibility="Collapsed"
                                                UseLayoutRounding="True"
                                                SnapsToDevicePixels="True"
                                                Cursor="Hand">
                                                <Image Height="52"
                                                       SnapsToDevicePixels="True"
                                                       UseLayoutRounding="True"
                                                       Stretch="Uniform"
                                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                                        </Button>

                                        <!-- Fallback till text (visas ENDAST när INGEN logga finns) -->
                                        <StackPanel x:Name="BrandFallback"
                                                    Orientation="Horizontal"
                                                    Visibility="Visible">
                                                <Border Width="46"
                                                        Height="46"
                                                        Margin="0,0,18,0"
                                                        VerticalAlignment="Center"
                                                        Background="{DynamicResource FK.Brush.Primary}"
                                                        CornerRadius="10">
                                                        <TextBlock Text="FK"
                                                                   FontWeight="Bold"
                                                                   FontSize="18"
                                                                   Foreground="White"
                                                                   HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                </Border>
                                                <TextBlock Text="FILKOLLEN"
                                                           FontWeight="Bold"
                                                           FontSize="26"
                                                           Foreground="{DynamicResource FK.Brush.Primary}"
                                                           VerticalAlignment="Center">
                                                        <TextBlock.TextEffects>
                                                                <TextEffect PositionStart="0"
                                                                                PositionCount="9">
                                                                        <TextEffect.Transform>
                                                                                <TranslateTransform X="0.3"/>
                                                                        </TextEffect.Transform>
                                                                </TextEffect>
                                                        </TextBlock.TextEffects>
                                                </TextBlock>
                                        </StackPanel>
                                </StackPanel>

                                <!-- Scanning progress -->
                                <StackPanel Grid.Column="1"
                                            x:Name="ScanningIndicator"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            Margin="20,0"
                                            Visibility="Collapsed">
                                        <TextBlock Text="🔍 Skannar..."
                                                   FontSize="13"
                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                   VerticalAlignment="Center"
                                                   Margin="0,0,12,0"/>
                                        <ProgressBar Style="{StaticResource ScanProgressBar}"
                                                     Width="120"
                                                     x:Name="ScanProgress"
                                                     Value="0"/>
                                </StackPanel>

                                <!-- Window controls -->
                                <StackPanel Grid.Column="2"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center"
                                            Margin="0,0,16,0">
                                        <!-- Ljus/Mörk tema toggle -->
                                        <StackPanel Orientation="Horizontal"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,16,0">
                                                <TextBlock Text="☀️"
                                                           FontSize="14"
                                                           VerticalAlignment="Center"
                                                           Margin="0,0,8,0"
                                                           Foreground="{DynamicResource FK.Brush.Subtext}"/>
                                                <ToggleButton x:Name="ThemeToggle"
                                                              Style="{DynamicResource FK.Style.ProtectionToggle}"
                                                              Width="43"
                                                              Height="22"
                                                              Checked="ThemeToggle_Checked"
                                                              Unchecked="ThemeToggle_Unchecked"/>
                                                <TextBlock Text="🌙"
                                                           FontSize="14"
                                                           VerticalAlignment="Center"
                                                           Margin="8,0,0,0"
                                                           Foreground="{DynamicResource FK.Brush.Subtext}"/>
                                        </StackPanel>

                                        <!-- Window controls -->
                                        <Button Content="−"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Minimize_Click"/>
                                        <Button Content="□"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Maximize_Click"/>
                                        <Button Content="✕"
                                                Width="36"
                                                Height="36"
                                                Margin="4,0"
                                                Style="{DynamicResource FK.Style.WindowButton}"
                                                Click="Close_Click"/>
                                </StackPanel>
                        </Grid>

                        <!-- === PROTECTION CONTROLS (Premium: Three tiles with enhanced spacing) === -->
                        <Grid Grid.Row="1"
                              Margin="24,0,24,24">
                                <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Auto-skydd panel -->
                                <Border Grid.Column="0"
                                        Style="{DynamicResource FK.Style.ProtectionCard}"
                                        MinHeight="140">
                                        <Grid>
                                                <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0"
                                                           Text="AUTO-SKYDD"
                                                           Style="{StaticResource HeaderTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,0,0,14"/>

                                                <ToggleButton Grid.Row="1"
                                                              x:Name="ProtectionToggle"
                                                              Style="{DynamicResource FK.Style.ProtectionToggle}"
                                                              Width="65"
                                                              Height="32"
                                                              HorizontalAlignment="Center"
                                                              Margin="0,0,0,14"
                                                              Checked="ProtectionToggle_Checked"
                                                              Unchecked="ProtectionToggle_Unchecked"/>

                                                <TextBlock Grid.Row="3"
                                                           Text="Övervakar filer i realtid."
                                                           Style="{StaticResource MetaTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           TextWrapping="Wrap"
                                                           TextAlignment="Center"
                                                           MaxWidth="180"/>
                                        </Grid>
                                </Border>

                                <!-- IP-Skydd panel -->
                                <Border Grid.Column="2"
                                        Style="{DynamicResource FK.Style.ProtectionCard}"
                                        MinHeight="140">
                                        <Grid>
                                                <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0"
                                                           Text="IP-SKYDD"
                                                           Style="{StaticResource HeaderTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,0,0,14"/>

                                                <ToggleButton Grid.Row="1"
                                                              x:Name="IpProtectionToggle"
                                                              Style="{DynamicResource FK.Style.ProtectionToggle}"
                                                              Width="65"
                                                              Height="32"
                                                              HorizontalAlignment="Center"
                                                              Margin="0,0,0,14"
                                                              Checked="IpProtectionToggle_Checked"
                                                              Unchecked="IpProtectionToggle_Unchecked"/>

                                                <TextBlock Grid.Row="3"
                                                           Text="Maskerar din IP-adress online."
                                                           Style="{StaticResource MetaTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           TextWrapping="Wrap"
                                                           TextAlignment="Center"
                                                           MaxWidth="180"/>
                                        </Grid>
                                </Border>

                                <!-- Webbläsarskydd panel (Premium: Moved browser clean here) -->
                                <Border Grid.Column="4"
                                        Style="{DynamicResource FK.Style.ProtectionCard}"
                                        MinHeight="140">
                                        <Grid>
                                                <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                        <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0"
                                                           Text="WEBBLÄSARSKYDD"
                                                           Style="{StaticResource HeaderTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           TextAlignment="Center"
                                                           Margin="0,0,0,14"/>

                                                <Button Grid.Row="1"
                                                        x:Name="BrowserCleanTileButton"
                                                        Content="Rensa bluffnotiser"
                                                        Style="{DynamicResource FK.Style.PrimaryButton}"
                                                        HorizontalAlignment="Center"
                                                        Padding="18,10"
                                                        FontSize="13"
                                                        Click="BrowserCleanButton_Click"/>

                                                <TextBlock Grid.Row="3"
                                                           Text="Tar bort falska varningar och bluffnotiser i webbläsaren."
                                                           Style="{StaticResource MetaTextStyle}"
                                                           HorizontalAlignment="Center"
                                                           TextWrapping="Wrap"
                                                           TextAlignment="Center"
                                                           MaxWidth="200"
                                                           Margin="0,14,0,0"/>
                                        </Grid>
                                </Border>
                        </Grid>

                        <!-- === STATUS OCH STATISTIK (Premium: Clean statusbar) === -->
                        <Grid Grid.Row="2"
                              Margin="24,0,24,24">
                                <Border Style="{DynamicResource FK.Style.StatusCard}">
                                        <Grid>
                                                <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>

                                                <!-- Status indikator och text -->
                                                <StackPanel Grid.Column="0"
                                                            Orientation="Horizontal"
                                                            VerticalAlignment="Center">
                                                        <Ellipse x:Name="StatusIndicator"
                                                                 Width="20"
                                                                 Height="20"
                                                                 Fill="{DynamicResource FK.Brush.StatusNeutral}"
                                                                 Margin="0,0,16,0"/>

                                                        <StackPanel>
                                                                <StackPanel Orientation="Horizontal">
                                                                        <TextBlock x:Name="StatusMainText"
                                                                                   Text="SYSTEMET ÄR SÄKERT"
                                                                                   Style="{StaticResource HeaderTextStyle}"
                                                                                   Foreground="{DynamicResource FK.Brush.Text}"/>
                                                                        <!-- Hot-räknare -->
                                                                        <Border x:Name="ThreatCounter"
                                                                                Background="{DynamicResource FK.Brush.Danger}"
                                                                                CornerRadius="16"
                                                                                Padding="12,4"
                                                                                Margin="16,0,0,0"
                                                                                Visibility="Collapsed">
                                                                                <TextBlock x:Name="ThreatCountText"
                                                                                           Text="2 HOT"
                                                                                           FontSize="13"
                                                                                           FontWeight="Bold"
                                                                                           Foreground="White"/>
                                                                        </Border>
                                                                </StackPanel>
                                                                <TextBlock x:Name="StatusSubText"
                                                                           Text="0 hot funna • Auto-skydd inaktivt"
                                                                           Style="{StaticResource MetaTextStyle}"/>
                                                        </StackPanel>
                                                </StackPanel>

                                                <!-- Statistik med mer luft -->
                                                <Border Grid.Column="2"
                                                        Background="{DynamicResource FK.Brush.Surface}"
                                                        CornerRadius="8"
                                                        Padding="18,12"
                                                        Margin="20,0">
                                                        <StackPanel>
                                                                <TextBlock Text="SENASTE SKANNING"
                                                                           FontSize="10"
                                                                           FontWeight="SemiBold"
                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                           HorizontalAlignment="Center"/>
                                                                <TextBlock x:Name="LastScanText"
                                                                           Text="Aldrig"
                                                                           FontSize="14"
                                                                           FontWeight="Medium"
                                                                           Foreground="{DynamicResource FK.Brush.Text}"
                                                                           HorizontalAlignment="Center"/>
                                                        </StackPanel>
                                                </Border>

                                                <Border Grid.Column="3"
                                                        Background="{DynamicResource FK.Brush.Surface}"
                                                        CornerRadius="8"
                                                        Padding="18,12"
                                                        Margin="10,0">
                                                        <StackPanel>
                                                                <TextBlock Text="HOT HANTERADE"
                                                                           FontSize="10"
                                                                           FontWeight="SemiBold"
                                                                           Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                           HorizontalAlignment="Center"/>
                                                                <TextBlock x:Name="ThreatsHandledText"
                                                                           Text="0"
                                                                           FontSize="14"
                                                                           FontWeight="Medium"
                                                                           Foreground="{DynamicResource FK.Brush.Text}"
                                                                           HorizontalAlignment="Center"/>
                                                        </StackPanel>
                                                </Border>

                                                <!-- Åtgärdsknappar (Premium: Endast "Sök efter hot") -->
                                                <StackPanel Grid.Column="4"
                                                            Orientation="Horizontal"
                                                            VerticalAlignment="Center"
                                                            Margin="20,0,0,0">
                                                        <Button x:Name="QuickScanButton"
                                                                Content="Sök efter hot"
                                                                Style="{DynamicResource FK.Style.PrimaryButton}"
                                                                Click="QuickScanButton_Click"/>
                                                </StackPanel>
                                        </Grid>
                                </Border>
                        </Grid>

                        <!-- === HUVUDINNEHÅLL === -->
                        <Grid Grid.Row="3"
                              Margin="24,0,24,24">
                                <Border Style="{DynamicResource FK.Style.ContentCard}">
                                        <Grid>
                                                <!-- Säker status -->
                                                <StackPanel x:Name="SafeStatusPanel"
                                                            Visibility="Visible">
                                                        <Border Width="100"
                                                                Height="100"
                                                                CornerRadius="50"
                                                                Background="{DynamicResource FK.Brush.Success}"
                                                                HorizontalAlignment="Center"
                                                                Margin="0,60,0,24">
                                                                <TextBlock Text="✓"
                                                                           FontSize="48"
                                                                           Foreground="White"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"/>
                                                        </Border>

                                                        <TextBlock Text="ALLT SER BRA UT!"
                                                                   FontSize="24"
                                                                   FontWeight="Bold"
                                                                   HorizontalAlignment="Center"
                                                                   Foreground="{DynamicResource FK.Brush.Success}"
                                                                   Margin="0,0,0,12"/>

                                                        <TextBlock Text="Allt ser bra ut! Aktivera auto-skydd för kontinuerlig övervakning."
                                                                   Style="{StaticResource BodyTextStyle}"
                                                                   TextAlignment="Center"
                                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                                   TextWrapping="Wrap"
                                                                   MaxWidth="500"
                                                                   LineHeight="24"
                                                                   HorizontalAlignment="Center"/>
                                                </StackPanel>

                                                <!-- Hot-lista (Premium: Enhanced spacing and colors) -->
                                                <StackPanel x:Name="ThreatsPanel"
                                                            Visibility="Collapsed">
                                                        <!-- Åtgärda alla-knapp överst (Premium: More space between buttons) -->
                                                        <DockPanel Margin="0,0,0,24">
                                                                <Button x:Name="HandleAllThreatsButton"
                                                                        Content="Ta bort alla hot"
                                                                        Style="{DynamicResource FK.Style.PrimaryButton}"
                                                                        DockPanel.Dock="Left"
                                                                        Click="HandleAllThreatsButton_Click"/>

                                                                <Button x:Name="RefreshScanButton"
                                                                        Content="Skanna om"
                                                                        Style="{DynamicResource FK.Style.SecondaryButton}"
                                                                        DockPanel.Dock="Right"
                                                                        Margin="16,0,0,0"
                                                                        Click="RefreshScanButton_Click"/>
                                                        </DockPanel>

                                                        <!-- Hot-tabell header -->
                                                        <Grid Margin="0,0,0,16">
                                                                <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="2*"/>
                                                                        <!-- Filnamn -->
                                                                        <ColumnDefinition Width="80"/>
                                                                        <!-- Typ -->
                                                                        <ColumnDefinition Width="80"/>
                                                                        <!-- Storlek -->
                                                                        <ColumnDefinition Width="100"/>
                                                                        <!-- Skapad -->
                                                                        <ColumnDefinition Width="80"/>
                                                                        <!-- Risk -->
                                                                        <ColumnDefinition Width="100"/>
                                                                        <!-- Åtgärd -->
                                                                </Grid.ColumnDefinitions>

                                                                <TextBlock Grid.Column="0"
                                                                           Text="FILNAMN"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="1"
                                                                           Text="TYP"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="2"
                                                                           Text="STORLEK"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="3"
                                                                           Text="SKAPAD"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="4"
                                                                           Text="RISK"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                                <TextBlock Grid.Column="5"
                                                                           Text="ÅTGÄRD"
                                                                           Style="{StaticResource MetaTextStyle}"
                                                                           FontWeight="SemiBold"/>
                                                        </Grid>

                                                        <!-- Separator -->
                                                        <Border Height="1"
                                                                Background="{DynamicResource FK.Brush.Border}"
                                                                Opacity="0.5"
                                                                Margin="0,0,0,16"/>

                                                        <!-- Hot-lista (scroll) -->
                                                        <ScrollViewer MaxHeight="350"
                                                                      VerticalScrollBarVisibility="Auto">
                                                                <StackPanel x:Name="ThreatsList">
                                                                        <!-- Dynamiska hot-rader läggs till här -->
                                                                </StackPanel>
                                                        </ScrollViewer>
                                                </StackPanel>
                                        </Grid>
                                </Border>
                        </Grid>

                        <!-- === FOOTER MED LICENSSTATUS (Premium: Clean layout) === -->
                        <Border Grid.Row="4"
                                Background="{DynamicResource FK.Brush.Surface}"
                                BorderBrush="{DynamicResource FK.Brush.Border}"
                                CornerRadius="0,0,16,16"
                                BorderThickness="0,1,0,0">
                                <Grid Margin="24,0">
                                        <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Vänster: Online status -->
                                        <StackPanel Grid.Column="0"
                                                    Orientation="Horizontal"
                                                    VerticalAlignment="Center">
                                                <Ellipse Width="8"
                                                         Height="8"
                                                         Margin="0,0,8,0"
                                                         Fill="{DynamicResource FK.Brush.Success}"/>
                                                <TextBlock x:Name="ConnectionStatusText"
                                                           Text="ONLINE"
                                                           FontSize="12"
                                                           FontWeight="SemiBold"
                                                           Foreground="{DynamicResource FK.Brush.Success}"/>
                                        </StackPanel>

                                        <!-- Center: Provperiod aktivt (klickbar och centrerad) -->
                                        <Button Grid.Column="1"
                                                x:Name="LicenseStatusButton"
                                                Click="LicenseStatusButton_Click"
                                                Style="{DynamicResource FK.Style.SecondaryButton}"
                                                Padding="20,12">
                                                <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="🔑"
                                                                   FontSize="16"
                                                                   Margin="0,0,10,0"/>
                                                        <TextBlock x:Name="LicenseStatusText"
                                                                   Text="PROVPERIOD AKTIVT"
                                                                   FontSize="12"
                                                                   FontWeight="SemiBold"/>
                                                </StackPanel>
                                        </Button>

                                        <!-- Höger: Version info -->
                                        <TextBlock Grid.Column="2"
                                                   Text="FilKollen v2.1"
                                                   FontSize="12"
                                                   Opacity="0.7"
                                                   Foreground="{DynamicResource FK.Brush.Subtext}"
                                                   HorizontalAlignment="Right"
                                                   VerticalAlignment="Center"/>
                                </Grid>
                        </Border>
                </Grid>
        </Border>
</Window>